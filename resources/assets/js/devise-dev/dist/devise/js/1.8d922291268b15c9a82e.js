webpackJsonp([1],{nmP3:function(e,t){e.exports=function(e,t){var s=null;return function(){clearTimeout(s);var a=arguments,n=this;s=setTimeout(function(){e.apply(n,a)},t)}}},uy23:function(e,t,s){const a=s("nmP3");function n(e,t){t.value!==t.oldValue&&(e.oninput=n.debounce(function(t){e.dispatchEvent(function(e){if("function"==typeof Event)var t=new Event(e);else{var t=document.createEvent("Event");t.initEvent(e,!0,!0)}return t}("change"))},parseInt(t.value)||800))}n.debounce=a,e.exports=n},w1aq:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("woOf"),n=s.n(a),l=s("Dd8w"),i=s.n(l),d=s("uy23"),o=s.n(d),r=s("+x/a"),u=s("NYxO"),v={name:"PagesIndex",data:function(){return{modulesToLoad:3,showCreate:!1,searchDelay:1e3,searchTerm:"",autosuggest:{data:[]},newPage:{template_id:null,language_id:null,translated_from_page_id:0,title:null,slug:null,canonical:null,head:null,footer:null,middleware:"web",published:!1}}},mounted:function(){this.retrieveAllPages(),this.retrieveAllTemplates(),this.retrieveAllLanguages()},methods:i()({},Object(u.b)("devise",["getPages","searchPages","getLanguages","getTemplates","createPage"]),{requestCreatePage:function(){var e=this;this.createPage(this.newPage).then(function(){e.newPage.template_id=null,e.newPage.language_id=null,e.newPage.title=null,e.newPage.slug=null,e.newPage.published=!1,e.showCreate=!1})},retrieveAllPages:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.getPages().then(function(){e&&window.bus.$emit("incrementLoadbar",self.modulesToLoad)})},retrieveAllTemplates:function(){var e=this;this.getTemplates().then(function(){window.bus.$emit("incrementLoadbar",e.modulesToLoad)})},retrieveAllLanguages:function(){var e=this;this.getLanguages().then(function(){window.bus.$emit("incrementLoadbar",e.modulesToLoad)})},loadPage:function(e){this.$router.push({name:"devise-pages-view",params:{pageId:e}})},requestSearch:function(e){var t=this;""!==e?this.searchPages(e).then(function(s){t.autosuggest=s,s.data.length<1&&window.bus.$emit("showMessage",{title:"No Suggestions Found",message:"We couldn't find any pages with the term: \""+e+'".'})}):this.autosuggest=n()({},{})}}),watch:{searchTerm:function(e){this.requestSearch(e)}},computed:i()({},Object(u.c)("devise",["templates","pages","languages","templates"]),{createInvalid:function(){return null===this.newPage.title||null===this.newPage.template_id||null===this.newPage.language_id||null===this.newPage.slug}}),components:{DeviseModal:r.a},directives:{debounce:o.a}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dvs-flex dvs-justify-end dvs-items-stretch dvs-min-h-screen dvs-relative"},[s("div",{attrs:{id:"devise-sidebar"}},[s("h2",{staticClass:"dvs-font-bold dvs-mb-2"},[e._v("Pages")]),e._v(" "),s("a",{staticClass:"dvs-mb-8 dvs-block dvs-uppercase dvs-font-bold dvs-text-xs",attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.goToPage("devise-index")}}},[e._v("Back to Main Menu")]),e._v(" "),s("ul",{staticClass:"dvs-list-reset"},[s("li",{staticClass:"dvs-cursor-pointer dvs-mb-6 dvs-text-lg dvs-cursor-pointer",on:{click:function(t){t.preventDefault(),e.showCreate=!0}}},[e._v("\n        Create New Page\n      ")])])]),e._v(" "),s("div",{attrs:{id:"devise-admin-content"}},[s("h2",{staticClass:"dvs-mb-10"},[e._v("Current Site Pages")]),e._v(" "),s("fieldset",{staticClass:"dvs-fieldset dvs-mb-8"},[s("label",[e._v("Search Pages")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.searchTerm,expression:"searchTerm",modifiers:{lazy:!0}},{name:"debounce",rawName:"v-debounce",value:e.searchDelay,expression:"searchDelay"}],attrs:{type:"text"},domProps:{value:e.searchTerm},on:{change:function(t){e.searchTerm=t.target.value}}}),e._v(" "),s("div",{staticClass:"dvs-relative"},[s("ul",{staticClass:"dvs-list-reset dvs-bg-white dvs-absolute dvs-shadow-lg"},e._l(e.autosuggest.data,function(t,a){return s("li",{staticClass:"dvs-border-b dvs-border-grey-lighter dvs-p-4 dvs-cursor-pointer",on:{click:function(t){e.loadPage(a)}}},[e._v("\n            "+e._s(t)+"\n          ")])}))])]),e._v(" "),e._l(e.pages.data,function(t){return s("div",{staticClass:"dvs-mb-6 dvs-rounded-sm dvs-bg-white dvs-shadow-sm dvs-flex dvs-justify-between dvs-items-center"},[s("div",{staticClass:"dvs-min-w-2/5 dvs-text-xl dvs-font-bold dvs-pr-8"},[e._v("\n        "+e._s(t.title)+"\n      ")]),e._v(" "),s("div",{staticClass:"dvs-min-w-1/5 dvs-text-normal dvs-px-8 dvs-font-mono"},[e._v("\n        "+e._s(t.slug)+"\n      ")]),e._v(" "),s("div",{staticClass:"dvs-w-2/5 dvs-px-8 dvs-flex dvs-justify-end"},[s("a",{staticClass:"dvs-btn dvs-btn-plain dvs-btn-xs dvs-mr-2",attrs:{href:t.slug}},[e._v("Go")]),e._v(" "),s("button",{staticClass:"dvs-btn dvs-btn-xs",on:{click:function(s){e.loadPage(t.id)}}},[e._v("Manage")])])])})],2),e._v(" "),s("transition",{attrs:{name:"fade"}},[e.showCreate?s("devise-modal",{staticClass:"dvs-z-50",on:{close:function(t){e.showTranslate=!1}}},[s("h4",{staticClass:"dvs-mb-4"},[e._v("Create new page")]),e._v(" "),s("fieldset",{staticClass:"dvs-fieldset mb-4"},[s("label",[e._v("Page Title")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPage.title,expression:"newPage.title"}],attrs:{type:"text",placeholder:"Title of the Page"},domProps:{value:e.newPage.title},on:{input:function(t){t.target.composing||e.$set(e.newPage,"title",t.target.value)}}})]),e._v(" "),s("fieldset",{staticClass:"dvs-fieldset mb-4"},[s("label",[e._v("Template")]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.newPage.template_id,expression:"newPage.template_id"}],on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.newPage,"template_id",t.target.multiple?s:s[0])}}},[s("option",{domProps:{value:null}},[e._v("Please select a template")]),e._v(" "),e._l(e.templates.data,function(t){return s("option",{domProps:{value:t.id}},[e._v(e._s(t.name))])})],2)]),e._v(" "),s("fieldset",{staticClass:"dvs-fieldset mb-4"},[s("label",[e._v("Language")]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.newPage.language_id,expression:"newPage.language_id"}],on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.newPage,"language_id",t.target.multiple?s:s[0])}}},[s("option",{domProps:{value:null}},[e._v("Please select a language")]),e._v(" "),e._l(e.languages.data,function(t){return s("option",{domProps:{value:t.id}},[e._v(e._s(t.code))])})],2)]),e._v(" "),s("fieldset",{staticClass:"dvs-fieldset mb-4"},[s("label",[e._v("Slug")]),e._v(" "),s("div",{staticClass:"dvs-flex"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPage.slug,expression:"newPage.slug"}],attrs:{type:"text",placeholder:"Url of the Page"},domProps:{value:e.newPage.slug},on:{input:function(t){t.target.composing||e.$set(e.newPage,"slug",t.target.value)}}})])]),e._v(" "),s("fieldset",{staticClass:"dvs-fieldset mb-4"},[s("label",[e._v("Published?")]),e._v(" "),s("div",{staticClass:"dvs-flex"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPage.published,expression:"newPage.published"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.newPage.published)?e._i(e.newPage.published,null)>-1:e.newPage.published},on:{change:function(t){var s=e.newPage.published,a=t.target,n=!!a.checked;if(Array.isArray(s)){var l=e._i(s,null);a.checked?l<0&&e.$set(e.newPage,"published",s.concat([null])):l>-1&&e.$set(e.newPage,"published",s.slice(0,l).concat(s.slice(l+1)))}else e.$set(e.newPage,"published",n)}}})])]),e._v(" "),s("button",{staticClass:"dvs-btn",attrs:{disabled:e.createInvalid},on:{click:e.requestCreatePage}},[e._v("Create")]),e._v(" "),s("button",{staticClass:"dvs-btn dvs-btn-plain",on:{click:function(t){e.showCreate=!1}}},[e._v("Cancel")])]):e._e()],1)],1)},staticRenderFns:[]},g=s("VU/8")(v,c,!1,null,null,null);t.default=g.exports}});